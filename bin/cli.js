!function(t){var r={};function n(e){if(r[e])return r[e].exports;var a=r[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=r,n.d=function(t,r,e){n.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:e})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,r){if(1&r&&(t=n(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(n.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var a in t)n.d(e,a,function(r){return t[r]}.bind(null,a));return e},n.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(r,"a",r),r},n.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},n.p="",n(n.s=0)}([function(t,r,n){"use strict";(function(t){function e(t){return function(t){if(Array.isArray(t)){for(var r=0,n=new Array(t.length);r<t.length;r++)n[r]=t[r];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}Object.defineProperty(r,"__esModule",{value:!0});var a,o,i,u,s,c=n(2),l=n(3),f=[{shortFlag:"t",longFlag:"text",nargs:1,required:!0},{shortFlag:"a",longFlag:"annotations",nargs:1,required:!0},{shortFlag:"s",longFlag:"simple",nargs:0,default:!0},{shortFlag:"p",longFlag:"paragraphs",nargs:0,default:!0}];n.c[n.s]===t&&(a=function(t,r){for(var n=new Map,a=new Set,o=t.reduce(function(t,r){return t.set(r.shortFlag,r),t.set(r.longFlag,r),r.hasOwnProperty("default")&&n.set(r.longFlag,r.default),r.required&&a.add(r.longFlag),t},new Map),i=e(r);i.length>0;){var u=i.shift(),s=u.startsWith("--")?u.substr(2):u.startsWith("-")?u.substr(1):"";if(!s||!o.has(s))throw new Error("Unrecognized flag: ".concat(u));var c=o.get(s);if(a.delete(c.longFlag),c.nargs>i.length)throw new Error("".concat(u," expected ").concat(c.nargs," arguments"));for(var l=[],f=0;f<c.nargs;f++)l.push(i.shift());switch(l.length){case 0:n.set(c.longFlag,!0);break;case 1:n.set(c.longFlag,l[0]);break;default:n.set(c.longFlag,l)}}if(a.size>0){var d=Array.from(a).join(", ");throw new Error("Missing required arguments: ".concat(d))}return n}(f,process.argv.slice(2)),o=c.readFileSync(a.get("text"),"utf-8"),i=c.readFileSync(a.get("annotations"),"utf-8"),u={autoParagraph:a.get("paragraphs"),simpleHTML:a.get("simple")},s=l.renderToString(o,JSON.parse(i),u),process.stdout.write(s))}).call(this,n(1)(t))},function(t,r){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,r){t.exports=require("fs")},function(t,r,n){"use strict";function e(t){return function(t){if(Array.isArray(t)){for(var r=0,n=new Array(t.length);r<t.length;r++)n[r]=t[r];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){var n=[],e=!0,a=!1,o=void 0;try{for(var i,u=t[Symbol.iterator]();!(e=(i=u.next()).done)&&(n.push(i.value),!r||n.length!==r);e=!0);}catch(t){a=!0,o=t}finally{try{e||null==u.return||u.return()}finally{if(a)throw o}}return n}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}Object.defineProperty(r,"__esModule",{value:!0});var o=n(4),i=new Set(["address","article","aside","blockquote","details","dialog","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","main","nav","ol","p","pre","section","table","ul"]);function u(t,r){var n=t.annotation.type,e=r.annotation.type,a=t.tagName.toLowerCase(),o=r.tagName.toLowerCase();if("p"===a)return-1;if("p"===o)return 1;if(n!==e){if("highlight"===n)return 1;if("highlight"===e)return-1}return i.has(a)?-1:i.has(o)?1:-1}function s(t,r){return t.start===r.start?t.end<r.end?1:-1:t.start<r.start?-1:1}function c(t,r,n){return{start:t,end:r,type:"markup",meta:{htmlTagName:"p",htmlClassName:n?"auto-para-break":void 0}}}var l={font:"font-family",fontSize:"font-size",color:"color",bgColor:"background-color",opacity:"opacity"};function f(t){var r=Object.keys(t).map(function(r){var n=t[r],e=l[r]||r;return"".concat(e,": ").concat(n)});return r.length?r.join("; ")+";":""}function d(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"span";return t.meta&&t.meta.htmlTagName?t.meta.htmlTagName.toLowerCase():r.toLowerCase()}function p(t,r,n,e){var o=d(t),i=[],u=function(t){var r=t.format;switch(t.type){case"redaction":return Object.assign({"white-space":"pre-wrap","word-break":"break-word"},r);default:return Object.assign({},r)}}(t);u&&(f(u)&&i.push(["style",f(u)]));t.meta&&t.meta.id&&i.push(["id",t.meta.id]);var s=e.simpleHTML?[]:["sharpie-annotation","sharpie-type-".concat(t.type)];t.meta&&t.meta.htmlClassName&&s.push(t.meta.htmlClassName),s.length&&i.push(["class",s.join(" ")]);var c=e.simpleHTML?"":" ".concat(v(r,n)),l=i.map(function(t){var r=a(t,2),n=r[0],e=r[1];return"".concat(n,'="').concat(e,'"')}).join(" "),p=l?" ".concat(l):"";return"<".concat(o).concat(c).concat(p,">")}function g(t,r){var n=d(t,r);return"</".concat(n,">")}function h(t,r,n){for(var e=(t=t||"").length,a=Math.max(e,r),o=r-e,i=o>>1,u=o-i,s=new Array(a),c=0,l=0;l<i;l++)s[c++]=n;for(var f=0;f<e;f++)s[c++]=t[f];for(var d=0;d<u;d++)s[c++]=n;return s}function v(t,r){return"__metadata_".concat(t,"_").concat(r,"__")}function m(t,r,n){if(null==t)return o._debug("Input missing, bailing out of render"),"";var l=[];(n=o.defaults(n,{autoParagraph:!0,simpleHTML:!1})).autoParagraph&&(o._debug("Generating HTML paragraph break annotations"),l=function(t,r){for(var n=[],e=/\n/g,a=0,o=null;null!==(o=e.exec(t));)n.push(c(a,o.index,!r.simpleHTML)),a=o.index;return n.push(c(a,t.length,!r.simpleHTML)),n}(t,n));var f=new WeakMap,m=new WeakMap;r.forEach(function(t,r){return f.set(t,"".concat(r))}),l.forEach(function(t,r){return f.set(t,"inferred-".concat(r))});for(var b,y,w,O,j=[].concat(e(r),e(l)).sort(s),_=[],M=[],x=[],P=[],F=new Map,S="",T=0;T<=t.length;T++){for(;M.length>0&&M[0].end===T;)for(var k=M[0];_.length>0;){var A=_.shift();S+=g(A.annotation),F.get(v(A.id,A.part)).end=T;for(var L=0;L<M.length;){var N=M[L];if(N.end>T)break;N===A.annotation?M.splice(L,1):L++}if(k===A.annotation)break;A.annotation.end>T&&x.unshift({annotation:A.annotation,id:A.id,part:A.part+1,start:T,end:-1,outputOffsetPos:-1,warp:-1})}for(var H=[];j.length>0&&j[0].start===T;){var C=j.shift();if(C.end<=C.start)o._debug("Ignoring invalid annotation range",C.start,C.end);else{for(var E=d(C),I=-1,q=_.length-1;q>=0;q--)if(b=_[q].annotation,y=C,w=void 0,O=void 0,w=d(b),O=d(y),!(i.has(O)&&!i.has(w)?(o._debug("Forcing inline reopen:",w,"cannot contain",O),0):"redaction"!==y.type||"highlight"!==b.type||(o._debug("Forcing highlight reopen: containing redaction"),0))){I=q;break}for(var z=0;z<=I;z++){var W=_.shift();S+=g(W.annotation),F.get(v(W.id,W.part)).end=T,x.unshift({annotation:W.annotation,id:W.id,part:W.part+1,start:T,end:-1,outputOffsetPos:-1,warp:-1}),z++}var D=1,G=void 0;if("redaction"===C.type){var J=C.end-C.start,R=C.extent?C.extent:Math.max(J,(C.content||"").length);G={redaction:C,output:h(C.content,R,"&nbsp;"),extent:R,cursor:0},D=J/R}m.set(C,D),H.push({annotation:C,tagName:E,redaction:G,part:0})}}for(;x.length>0;){var U=x.shift();H.push({annotation:U.annotation,tagName:d(U.annotation),part:U.part})}for(H.sort(u);H.length>0;){var B=H.shift(),K=B.annotation;0===B.part&&(o.sortedInsert(M,K,function(t){return t.end}),B.redaction&&P.unshift(B.redaction));var Q={annotation:K,id:f.get(K),part:B.part,start:T,end:-1,warp:m.get(K),outputOffsetPos:S.length};S+=p(K,f.get(K),B.part,n);var V=v(Q.id,Q.part);F.has(V)&&o._error("Overwriting node metadata",V),F.set(V,Q),_.unshift(Q)}for(var X=P.length-1;X>=0;X--){var Y=P[X];if(!Y)break;Y.redaction.end<=T&&P.splice(X,1)}for(var Z=0;Z<P.length;Z++){var $=P[Z],tt=$.cursor,rt=(1+T-$.redaction.start)/($.redaction.end-$.redaction.start)*$.extent;$.cursor=Math.floor(rt);for(var nt=0===Z&&$.cursor>tt;nt&&tt<$.cursor;)S+=$.output[tt++]}0===P.length&&(S+=t[T]||"")}return n.simpleHTML?S:function(t,r){var n=!0,e=!1,o=void 0;try{for(var i,u=r[Symbol.iterator]();!(n=(i=u.next()).done);n=!0){var s=a(i.value,2),c=s[0],l=s[1],f=['data-sharpie-start="'.concat(l.start,'"'),'data-sharpie-end="'.concat(l.end,'"'),'data-sharpie-warp="'.concat(l.warp,'"'),'data-sharpie-id="'.concat(l.id,'"')].join(" "),d=t.substring(0,l.outputOffsetPos),p=t.substring(l.outputOffsetPos).replace(c,f);t=d+p}}catch(t){e=!0,o=t}finally{try{n||null==u.return||u.return()}finally{if(e)throw o}}return t}(S,F)}r.renderToString=m,r.render=function(t,r,n){var e=Date.now(),a=m(r,n);o._debug("Rendered in",Date.now()-e,"ms"),t.innerHTML=a}},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r._debug=function(){},r._error=function(){},r.defaults=function(t,r){return t?Object.assign({},r,t):Object.assign({},r)},r.identity=function(t){return t},r.sortedInsert=function(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.identity,a=e(n);if(0!==t.length){for(var o=0,i=t.length;i-o>1;){var u=o+(i-o>>1),s=e(t[u]);a<s?i=u:o=u}var c=a<=e(t[o])?o:i;t.splice(c,0,n)}else t.push(n)}}]);