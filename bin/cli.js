!function(t){var n={};function r(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=n,r.d=function(t,n,e){r.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,n){if(1&n&&(t=r(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var a in t)r.d(e,a,function(n){return t[n]}.bind(null,a));return e},r.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(n,"a",n),n},r.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},r.p="",r(r.s=0)}([function(t,n,r){"use strict";(function(t){function e(t){return function(t){if(Array.isArray(t)){for(var n=0,r=new Array(t.length);n<t.length;n++)r[n]=t[n];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}Object.defineProperty(n,"__esModule",{value:!0});var a,o,i,u,s,c=r(2),l=r(3),f=[{shortFlag:"t",longFlag:"text",nargs:1,required:!0},{shortFlag:"a",longFlag:"annotations",nargs:1,required:!0},{shortFlag:"s",longFlag:"simple",nargs:0,default:!0},{shortFlag:"p",longFlag:"paragraphs",nargs:0,default:!0}];r.c[r.s]===t&&(a=function(t,n){for(var r=new Map,a=new Set,o=t.reduce(function(t,n){return t.set(n.shortFlag,n),t.set(n.longFlag,n),n.hasOwnProperty("default")&&r.set(n.longFlag,n.default),n.required&&a.add(n.longFlag),t},new Map),i=e(n);i.length>0;){var u=i.shift(),s=u.startsWith("--")?u.substr(2):u.startsWith("-")?u.substr(1):"";if(!s||!o.has(s))throw new Error("Unrecognized flag: ".concat(u));var c=o.get(s);if(a.delete(c.longFlag),c.nargs>i.length)throw new Error("".concat(u," expected ").concat(c.nargs," arguments"));for(var l=[],f=0;f<c.nargs;f++)l.push(i.shift());switch(l.length){case 0:r.set(c.longFlag,!0);break;case 1:r.set(c.longFlag,l[0]);break;default:r.set(c.longFlag,l)}}if(a.size>0){var d=Array.from(a).join(", ");throw new Error("Missing required arguments: ".concat(d))}return r}(f,process.argv.slice(2)),o=c.readFileSync(a.get("text"),"utf-8"),i=c.readFileSync(a.get("annotations"),"utf-8"),u={autoParagraph:a.get("paragraphs"),simpleHTML:a.get("simple")},s=l.renderToString(o,JSON.parse(i),u),process.stdout.write(s))}).call(this,r(1)(t))},function(t,n){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,n){t.exports=require("fs")},function(t,n,r){"use strict";function e(t){return function(t){if(Array.isArray(t)){for(var n=0,r=new Array(t.length);n<t.length;n++)r[n]=t[n];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var r=[],e=!0,a=!1,o=void 0;try{for(var i,u=t[Symbol.iterator]();!(e=(i=u.next()).done)&&(r.push(i.value),!n||r.length!==n);e=!0);}catch(t){a=!0,o=t}finally{try{e||null==u.return||u.return()}finally{if(a)throw o}}return r}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}Object.defineProperty(n,"__esModule",{value:!0});var o=r(4),i=new Set(["address","article","aside","blockquote","details","dialog","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","main","nav","ol","p","pre","section","table","ul"]);function u(t,n){var r=t.annotation.type,e=n.annotation.type,a=t.tagName.toLowerCase(),o=n.tagName.toLowerCase();if("p"===a)return-1;if("p"===o)return 1;if(r!==e){if("highlight"===r)return 1;if("highlight"===e)return-1}return i.has(a)?-1:i.has(o)?1:-1}function s(t,n){return t.start===n.start?t.end<n.end?1:-1:t.start<n.start?-1:1}function c(t,n,r){return{start:t,end:n,type:"markup",meta:{htmlTagName:"p",htmlClassName:r?"auto-para-break":void 0}}}var l={font:"font-family",fontSize:"font-size",color:"color",bgColor:"background-color",opacity:"opacity"};function f(t){var n=Object.keys(t).map(function(n){var r=t[n],e=l[n]||n;return"".concat(e,": ").concat(r)});return n.length?n.join("; ")+";":""}function d(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"span";return t.meta&&t.meta.htmlTagName?t.meta.htmlTagName.toLowerCase():n.toLowerCase()}function g(t,n,r,e){var o=d(t),i=[],u=function(t){var n=t.format;switch(t.type){case"redaction":return Object.assign({"white-space":"pre-wrap","word-break":"break-word"},n);default:return Object.assign({},n)}}(t);u&&(f(u)&&i.push(["style",f(u)]));t.meta&&t.meta.id&&i.push(["id",t.meta.id]);var s=e.simpleHTML?[]:["sharpie-annotation","sharpie-type-".concat(t.type)];t.meta&&t.meta.htmlClassName&&s.push(t.meta.htmlClassName),s.length&&i.push(["class",s.join(" ")]);var c=e.simpleHTML?"":" ".concat(v(n,r)),l=i.map(function(t){var n=a(t,2),r=n[0],e=n[1];return"".concat(r,'="').concat(e,'"')}).join(" "),g=l?" ".concat(l):"";return"<".concat(o).concat(c).concat(g,">")}function p(t,n){var r=d(t,n);return"</".concat(r,">")}function h(t,n,r){for(var e=(t=t||"").length,a=Math.max(e,n),o=n-e,i=o>>1,u=o-i,s=new Array(a),c=0,l=0;l<i;l++)s[c++]=r;for(var f=0;f<e;f++)s[c++]=t[f];for(var d=0;d<u;d++)s[c++]=r;return s}function v(t,n){return"__metadata_".concat(t,"_").concat(n,"__")}function m(t,n,r){if(null==t)return o._debug("Input missing, bailing out of render"),"";var l=[];(r=o.defaults(r,{autoParagraph:!0,simpleHTML:!1})).autoParagraph&&(o._debug("Generating HTML paragraph break annotations"),l=function(t,n){for(var r=[],e=/\n/g,a=0,o=null;null!==(o=e.exec(t));)r.push(c(a,o.index,!n.simpleHTML)),a=o.index;return r.push(c(a,t.length,!n.simpleHTML)),r}(t,r));var f=new WeakMap,m=new WeakMap;n.forEach(function(t,n){return f.set(t,"".concat(n))}),l.forEach(function(t,n){return f.set(t,"inferred-".concat(n))});for(var y,b,w,O,j=[].concat(e(n),e(l)).sort(s),_=[],M=[],x=[],P=[],F=new Map,S="",T=0;T<=t.length;T++){for(;M.length>0&&M[0].end===T;)for(var k=M[0];_.length>0;){var A=_.shift();S+=p(A.annotation),F.get(v(A.id,A.part)).end=T;for(var L=0;L<M.length;){var N=M[L];if(N.end>T)break;N===A.annotation?M.splice(L,1):L++}if(k===A.annotation)break;A.annotation.end>T&&x.unshift({annotation:A.annotation,id:A.id,part:A.part+1,start:T,end:-1,outputOffsetPos:-1,warp:-1})}for(var H=[];j.length>0&&j[0].start===T;){var C=j.shift();if(C.end<=C.start)o._debug("Ignoring invalid annotation range",C.start,C.end);else{for(var E=d(C),I=-1,q=_.length-1;q>=0;q--)if(y=_[q].annotation,b=C,w=void 0,O=void 0,w=d(y),O=d(b),!(i.has(O)&&!i.has(w)?(o._debug("Forcing inline reopen:",w,"cannot contain",O),0):"redaction"!==b.type||"highlight"!==y.type||(o._debug("Forcing highlight reopen: containing redaction"),0))){I=q;break}for(var z=0;z<=I;z++){var W=_.shift();S+=p(W.annotation),F.get(v(W.id,W.part)).end=T,x.unshift({annotation:W.annotation,id:W.id,part:W.part+1,start:T,end:-1,outputOffsetPos:-1,warp:-1}),z++}var D=1,G=void 0;if("redaction"===C.type){var J=C.end-C.start,R=C.extent?C.extent:Math.max(J,(C.content||"").length);G={redaction:C,output:h(C.content,R,"&nbsp;"),extent:R,cursor:0},D=J/R}m.set(C,D),H.push({annotation:C,tagName:E,redaction:G,part:0})}}for(;x.length>0;){var U=x.shift();H.push({annotation:U.annotation,tagName:d(U.annotation),part:U.part})}for(H.sort(u);H.length>0;){var B=H.shift(),K=B.annotation;0===B.part&&(o.sortedInsert(M,K,function(t){return t.end}),B.redaction&&P.unshift(B.redaction));var Q={annotation:K,id:f.get(K),part:B.part,start:T,end:-1,warp:m.get(K),outputOffsetPos:S.length};S+=g(K,f.get(K),B.part,r);var V=v(Q.id,Q.part);F.has(V)&&o._error("Overwriting node metadata",V),F.set(V,Q),_.unshift(Q)}for(;P.length&&P[0].redaction.end===T;)P.shift();for(var X=0;X<P.length;X++){var Y=P[X],Z=Y.cursor,$=(1+T-Y.redaction.start)/(Y.redaction.end-Y.redaction.start)*Y.extent;Y.cursor=Math.floor($);for(var tt=0===X&&Y.cursor>Z;tt&&Z<Y.cursor;)S+=Y.output[Z++]}0===P.length&&(S+=t[T]||"")}return r.simpleHTML?S:function(t,n){var r=!0,e=!1,o=void 0;try{for(var i,u=n[Symbol.iterator]();!(r=(i=u.next()).done);r=!0){var s=a(i.value,2),c=s[0],l=s[1],f=['data-sharpie-start="'.concat(l.start,'"'),'data-sharpie-end="'.concat(l.end,'"'),'data-sharpie-warp="'.concat(l.warp,'"'),'data-sharpie-id="'.concat(l.id,'"')].join(" "),d=t.substring(0,l.outputOffsetPos),g=t.substring(l.outputOffsetPos).replace(c,f);t=d+g}}catch(t){e=!0,o=t}finally{try{r||null==u.return||u.return()}finally{if(e)throw o}}return t}(S,F)}n.renderToString=m,n.render=function(t,n,r){var e=Date.now(),a=m(n,r);o._debug("Rendered in",Date.now()-e,"ms"),t.innerHTML=a}},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n._debug=function(){},n._error=function(){},n.defaults=function(t,n){return t?Object.assign({},n,t):Object.assign({},n)},n.identity=function(t){return t},n.sortedInsert=function(t,r){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.identity,a=e(r);if(0!==t.length){for(var o=0,i=t.length;i-o>1;){var u=o+(i-o>>1),s=e(t[u]);a<s?i=u:o=u}var c=a<=e(t[o])?o:i;t.splice(c,0,r)}else t.push(r)}}]);